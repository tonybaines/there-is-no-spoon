= There Is No Spoon
2020-03-13
Tony Baines
:docinfo: shared
:source-highlighter: highlightjs
:icons: font
:revealjs_theme: solarized
:revealjs_slideNumber: h.v
:revealjs_hash: true
:revealjs_history: true
:revealjs_plugin_pdf: enabled
:showNotes: "separate-page"

== Computers can't count
* They can't do addition / subtraction
* They can't do multiplication / division

=== Overflow
[source,java]
----
int i = 2147483647;
println(i + 1); //-2147483648 (overflow)

int i = -2147483648;
println(i - 1); // 2147483647 (underflow)
----

=== Precision
* IEEE 754 standard for floating point

[source,java]
----
// JShell REPL
1/3 = 0 // Integer
1/3.0 = 0.3333333333333333 // Double
1/3.0f = 0.33333334 // Float

(1/3.0f) * 3 = 1.0
(1/3.0f) * 3.0f = 1.0 // Float * Float
(1/3.0f) * 3.0 = 1.0000000298023224 // Float * Double
----


== Time does not exist
* Scheduled and repeating tasks
* Keys with a time component

=== Non-network time
* The clocks on your servers may not agree
* Use NTP

=== Not monotonic
* NTP can 'jump' backwards and forwards to correct system time

=== VM pauses
* If your system runs on virtualised hardware
* If your application runs in a GC'd runtime
* Time can jump forwards in a hurry

=== DST
* On (CHECK DATE) it was 1:00am twice

=== Zones
* If your server is configured to use local time ...

== The network isn't reliable

=== Connectivity
* Partial protocol negotiation
* The client can crash at *any* time

=== Timeliness
* The 99th percentile delay can be *huge*


== The Data is Wrong

=== Consistency/Consensus
* Split brain
* Which write wins?

=== Transactions
* System A needs to write to System B and C
** System B write succeeds, System C write fails
** What next?


== You can't trust the logs

=== Copy-and-paste error handling

=== Bad assumptions (wrong reason logged)
* (Example from BLIS here)

== You can't trust upstream

=== Bad data
* Unexpected
* Invalid
* Malicious

=== DoS
* Failures re-tried in a tight loop
* High load passed on
* Inefficient / not caching the cacheable

== You can't trust downstream

=== Slow responses
* Consume your application resources
* Timeout / retry make make it worse (DoS)

=== Bad data
* API changes
* Schema mis-match